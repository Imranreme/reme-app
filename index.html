<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REME - Smart Medication Reminder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .location-ping {
            animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        
        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        
        .slide-up {
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white p-6 shadow-lg">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="bg-white p-2 rounded-full">
                    <svg class="w-8 h-8 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-2xl font-bold">REME</h1>
                    <p class="text-sm opacity-90">Smart Medication Reminder</p>
                </div>
            </div>
            <div class="flex items-center space-x-2">
                <div id="locationStatus" class="flex items-center space-x-1">
                    <div class="w-3 h-3 bg-green-400 rounded-full location-ping"></div>
                    <span class="text-xs">GPS Active</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Location Permission Banner -->
    <div id="locationBanner" class="bg-blue-600 text-white p-4 text-center hidden">
        <p class="text-sm mb-2">üìç Enable location access for pharmacy proximity alerts</p>
        <button onclick="requestLocationPermission()" class="bg-white text-blue-600 px-4 py-1 rounded text-sm font-medium">
            Enable Location
        </button>
    </div>

    <!-- Main Content -->
    <main class="max-w-md mx-auto p-4 space-y-6">
        <!-- Today's Medications -->
        <div class="bg-white rounded-xl card-shadow p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-gray-800">Today's Medications</h2>
                <div class="flex items-center space-x-2">
                    <button onclick="syncWithPharmacy()" class="text-blue-600 text-sm">
                        üîÑ Sync
                    </button>
                </div>
            </div>
            
            <div class="space-y-3" id="todayMedications">
                <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        <div>
                            <p class="font-medium text-sm">Paracetamol 500mg</p>
                            <p class="text-xs text-gray-600">8:00 AM - Taken ‚úì</p>
                        </div>
                    </div>
                    <button class="text-green-600 text-xs">‚úì</button>
                </div>
                
                <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200 pulse-animation">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        <div>
                            <p class="font-medium text-sm">Amoxicillin 250mg</p>
                            <p class="text-xs text-gray-600">1:00 PM - Due Now!</p>
                        </div>
                    </div>
                    <button onclick="markAsTaken('amoxicillin')" class="bg-yellow-500 text-white px-3 py-1 rounded text-xs">
                        Take Now
                    </button>
                </div>
                
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-gray-400 rounded-full"></div>
                        <div>
                            <p class="font-medium text-sm">Vitamin D3</p>
                            <p class="text-xs text-gray-600">8:00 PM - Upcoming</p>
                        </div>
                    </div>
                    <button onclick="setAlarmReminder('vitamin-d3', '20:00')" class="text-blue-600 text-xs">
                        üîî Set Alarm
                    </button>
                </div>
            </div>
        </div>

        <!-- Nearby Pharmacies -->
        <div class="bg-white rounded-xl card-shadow p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-semibold text-gray-800">Nearby Pharmacies</h2>
                <button onclick="openGoogleMaps()" class="text-blue-600 text-sm">
                    üó∫Ô∏è View Map
                </button>
            </div>
            
            <div class="space-y-3" id="nearbyPharmacies">
                <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-green-500 rounded-full location-ping"></div>
                        <div>
                            <p class="font-medium text-sm">MedPlus Pharmacy</p>
                            <p class="text-xs text-gray-600">üìç 85m away - You're nearby!</p>
                        </div>
                    </div>
                    <button onclick="getDirections('MedPlus Pharmacy')" class="bg-green-600 text-white px-3 py-1 rounded text-xs">
                        Directions
                    </button>
                </div>
                
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-blue-500 rounded-full"></div>
                        <div>
                            <p class="font-medium text-sm">Apollo Pharmacy</p>
                            <p class="text-xs text-gray-600">üìç 250m away</p>
                        </div>
                    </div>
                    <button onclick="getDirections('Apollo Pharmacy')" class="text-blue-600 text-xs">
                        Directions
                    </button>
                </div>
                
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-gray-400 rounded-full"></div>
                        <div>
                            <p class="font-medium text-sm">Guardian Pharmacy</p>
                            <p class="text-xs text-gray-600">üìç 450m away</p>
                        </div>
                    </div>
                    <button onclick="getDirections('Guardian Pharmacy')" class="text-blue-600 text-xs">
                        Directions
                    </button>
                </div>
            </div>
        </div>

        <!-- Refill Alerts -->
        <div class="bg-white rounded-xl card-shadow p-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4">Refill Alerts</h2>
            
            <div class="space-y-3">
                <div class="flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-red-500 rounded-full pulse-animation"></div>
                        <div>
                            <p class="font-medium text-sm">Amoxicillin 250mg</p>
                            <p class="text-xs text-gray-600">‚ö†Ô∏è 3 days remaining</p>
                        </div>
                    </div>
                    <button onclick="orderRefill('amoxicillin')" class="bg-red-600 text-white px-3 py-1 rounded text-xs">
                        Order Now
                    </button>
                </div>
                
                <div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                    <div class="flex items-center space-x-3">
                        <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                        <div>
                            <p class="font-medium text-sm">Paracetamol 500mg</p>
                            <p class="text-xs text-gray-600">‚è∞ 7 days remaining</p>
                        </div>
                    </div>
                    <button onclick="setRefillReminder('paracetamol')" class="text-yellow-600 text-xs">
                        üîî Remind Me
                    </button>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-xl card-shadow p-6">
            <h2 class="text-lg font-semibold text-gray-800 mb-4">Quick Actions</h2>
            
            <div class="grid grid-cols-2 gap-3">
                <button onclick="addMedication()" class="bg-purple-600 text-white p-3 rounded-lg text-sm font-medium">
                    ‚ûï Add Medicine
                </button>
                <button onclick="viewHistory()" class="bg-blue-600 text-white p-3 rounded-lg text-sm font-medium">
                    üìä View History
                </button>
                <button onclick="emergencyContacts()" class="bg-red-600 text-white p-3 rounded-lg text-sm font-medium">
                    üö® Emergency
                </button>
                <button onclick="settingsMenu()" class="bg-gray-600 text-white p-3 rounded-lg text-sm font-medium">
                    ‚öôÔ∏è Settings
                </button>
            </div>
        </div>
    </main>

    <!-- Location Alert Modal -->
    <div id="locationAlertModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-sm mx-4 slide-up">
            <div class="text-center">
                <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-800 mb-2">You're near MedPlus Pharmacy!</h3>
                <p class="text-sm text-gray-600 mb-4">Perfect time to pick up your Amoxicillin refill. Only 85m away!</p>
                
                <div class="space-y-3">
                    <button onclick="getDirections('MedPlus Pharmacy')" class="w-full bg-green-600 text-white py-2 rounded-lg">
                        Get Directions
                    </button>
                    <button onclick="callPharmacy('MedPlus')" class="w-full bg-blue-600 text-white py-2 rounded-lg">
                        Call Pharmacy
                    </button>
                    <button onclick="closeModal('locationAlertModal')" class="w-full bg-gray-300 text-gray-700 py-2 rounded-lg">
                        Dismiss
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Alarm Setup Modal -->
    <div id="alarmSetupModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-sm mx-4 slide-up">
            <div class="text-center">
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                    </svg>
                </div>
                <h3 class="text-lg font-semibold text-gray-800 mb-2">Set Medication Alarm</h3>
                <p class="text-sm text-gray-600 mb-4" id="alarmMedicationName">Vitamin D3 - 8:00 PM</p>
                
                <div class="space-y-3">
                    <button onclick="setPhoneAlarm()" class="w-full bg-blue-600 text-white py-2 rounded-lg">
                        üîî Set Phone Alarm
                    </button>
                    <button onclick="setAppNotification()" class="w-full bg-purple-600 text-white py-2 rounded-lg">
                        üì± App Notification Only
                    </button>
                    <button onclick="closeModal('alarmSetupModal')" class="w-full bg-gray-300 text-gray-700 py-2 rounded-lg">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Notification -->
    <div id="successNotification" class="fixed top-4 right-4 bg-green-600 text-white p-4 rounded-lg shadow-lg hidden slide-up">
        <div class="flex items-center space-x-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span id="notificationMessage">Action completed successfully!</span>
        </div>
    </div>

    <script>
        let userLocation = null;
        let watchId = null;
        let currentMedication = null;

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            checkLocationPermission();
            loadMedicationData();
            startLocationTracking();
            
            // Simulate receiving pharmacy bill data
            setTimeout(() => {
                const pharmacyData = localStorage.getItem('lastREMEIntegration');
                if (pharmacyData) {
                    processPharmaycBill(JSON.parse(pharmacyData));
                }
            }, 1000);
        });

        // Location permission and tracking
        function checkLocationPermission() {
            if ('geolocation' in navigator) {
                navigator.permissions.query({name: 'geolocation'}).then(function(result) {
                    if (result.state === 'granted') {
                        document.getElementById('locationStatus').innerHTML = `
                            <div class="w-3 h-3 bg-green-400 rounded-full location-ping"></div>
                            <span class="text-xs">GPS Active</span>
                        `;
                    } else {
                        document.getElementById('locationBanner').classList.remove('hidden');
                    }
                });
            }
        }

        function requestLocationPermission() {
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    userLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    document.getElementById('locationBanner').classList.add('hidden');
                    document.getElementById('locationStatus').innerHTML = `
                        <div class="w-3 h-3 bg-green-400 rounded-full location-ping"></div>
                        <span class="text-xs">GPS Active</span>
                    `;
                    startLocationTracking();
                    showNotification('üìç Location access enabled! Pharmacy alerts are now active.');
                },
                function(error) {
                    showNotification('‚ùå Location access denied. Some features may not work.');
                }
            );
        }

        function startLocationTracking() {
            if ('geolocation' in navigator) {
                watchId = navigator.geolocation.watchPosition(
                    function(position) {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        checkPharmacyProximity();
                    },
                    function(error) {
                        console.log('Location tracking error:', error);
                    },
                    {
                        enableHighAccuracy: true,
                        maximumAge: 30000,
                        timeout: 27000
                    }
                );
            }
        }

        function checkPharmacyProximity() {
            // Simulate pharmacy locations
            const pharmacies = [
                { name: 'MedPlus Pharmacy', lat: 12.9716, lng: 77.5946, distance: 85 },
                { name: 'Apollo Pharmacy', lat: 12.9726, lng: 77.5956, distance: 250 },
                { name: 'Guardian Pharmacy', lat: 12.9736, lng: 77.5966, distance: 450 }
            ];

            pharmacies.forEach(pharmacy => {
                if (pharmacy.distance <= 100) {
                    // User is within 100m of pharmacy
                    triggerPharmacyAlert(pharmacy);
                }
            });
        }

        function triggerPharmacyAlert(pharmacy) {
            // Check if user has pending refills
            const pendingRefills = ['Amoxicillin 250mg'];
            
            if (pendingRefills.length > 0) {
                // Show location alert modal
                document.getElementById('locationAlertModal').classList.remove('hidden');
                document.getElementById('locationAlertModal').classList.add('flex');
                
                // Trigger phone notification
                if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification(`You're near ${pharmacy.name}!`, {
                        body: 'Perfect time to pick up your medication refill.',
                        icon: '/favicon.ico',
                        tag: 'pharmacy-proximity'
                    });
                }
                
                // Vibrate if supported
                if ('vibrate' in navigator) {
                    navigator.vibrate([200, 100, 200]);
                }
            }
        }

        // Google Maps integration
        function openGoogleMaps() {
            if (userLocation) {
                const mapsUrl = `https://www.google.com/maps/search/pharmacy/@${userLocation.lat},${userLocation.lng},15z`;
                window.open(mapsUrl, '_blank');
            } else {
                const mapsUrl = 'https://www.google.com/maps/search/pharmacy';
                window.open(mapsUrl, '_blank');
            }
            showNotification('üó∫Ô∏è Opening Google Maps to find nearby pharmacies...');
        }

        function getDirections(pharmacyName) {
            let destination = '';
            
            switch(pharmacyName) {
                case 'MedPlus Pharmacy':
                    destination = 'MedPlus+Pharmacy+near+me';
                    break;
                case 'Apollo Pharmacy':
                    destination = 'Apollo+Pharmacy+near+me';
                    break;
                case 'Guardian Pharmacy':
                    destination = 'Guardian+Pharmacy+near+me';
                    break;
                default:
                    destination = pharmacyName.replace(' ', '+');
            }
            
            const directionsUrl = `https://www.google.com/maps/dir/?api=1&destination=${destination}`;
            window.open(directionsUrl, '_blank');
            showNotification(`üß≠ Getting directions to ${pharmacyName}...`);
        }

        // Phone alarm integration
        function setAlarmReminder(medicationId, time) {
            currentMedication = { id: medicationId, time: time, name: 'Vitamin D3' };
            document.getElementById('alarmSetupModal').classList.remove('hidden');
            document.getElementById('alarmSetupModal').classList.add('flex');
        }

        function setPhoneAlarm() {
            // Try to use the device's alarm app
            const alarmTime = currentMedication.time;
            const medicationName = currentMedication.name;
            
            // For Android devices
            if (navigator.userAgent.includes('Android')) {
                const alarmIntent = `intent://alarm#Intent;scheme=android.intent.action.SET_ALARM;S.android.intent.extra.alarm.MESSAGE=Take ${medicationName};i.android.intent.extra.alarm.HOUR=${parseInt(alarmTime.split(':')[0])};i.android.intent.extra.alarm.MINUTES=${parseInt(alarmTime.split(':')[1])};end`;
                window.location.href = alarmIntent;
            } 
            // For iOS devices
            else if (navigator.userAgent.includes('iPhone') || navigator.userAgent.includes('iPad')) {
                // iOS doesn't allow direct alarm setting, so we'll use a workaround
                const alarmUrl = `clock-alarm://`;
                window.location.href = alarmUrl;
            }
            // Fallback for other devices
            else {
                // Set a browser-based reminder
                setAppNotification();
                return;
            }
            
            closeModal('alarmSetupModal');
            showNotification(`‚è∞ Phone alarm set for ${alarmTime} - ${medicationName}`);
        }

        function setAppNotification() {
            // Request notification permission
            if ('Notification' in window) {
                Notification.requestPermission().then(function(permission) {
                    if (permission === 'granted') {
                        // Calculate time until medication
                        const now = new Date();
                        const [hours, minutes] = currentMedication.time.split(':');
                        const medicationTime = new Date();
                        medicationTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                        
                        if (medicationTime <= now) {
                            medicationTime.setDate(medicationTime.getDate() + 1);
                        }
                        
                        const timeUntil = medicationTime.getTime() - now.getTime();
                        
                        setTimeout(() => {
                            new Notification(`Time to take ${currentMedication.name}!`, {
                                body: `It's ${currentMedication.time} - Don't forget your medication.`,
                                icon: '/favicon.ico',
                                tag: 'medication-reminder',
                                requireInteraction: true
                            });
                            
                            // Vibrate
                            if ('vibrate' in navigator) {
                                navigator.vibrate([500, 200, 500, 200, 500]);
                            }
                        }, timeUntil);
                        
                        closeModal('alarmSetupModal');
                        showNotification(`üì± App notification set for ${currentMedication.time} - ${currentMedication.name}`);
                    }
                });
            }
        }

        // Medication management
        function markAsTaken(medicationId) {
            // Update UI to show medication as taken
            const medicationElement = document.querySelector(`[data-medication="${medicationId}"]`);
            if (medicationElement) {
                medicationElement.classList.remove('bg-yellow-50', 'border-yellow-200', 'pulse-animation');
                medicationElement.classList.add('bg-green-50', 'border-green-200');
                medicationElement.querySelector('.bg-yellow-500').classList.remove('bg-yellow-500');
                medicationElement.querySelector('.rounded-full').classList.add('bg-green-500');
            }
            
            showNotification('‚úÖ Medication marked as taken!');
            
            // Log to medication history
            const medicationLog = JSON.parse(localStorage.getItem('medicationLog') || '[]');
            medicationLog.push({
                medication: 'Amoxicillin 250mg',
                time: new Date().toISOString(),
                status: 'taken'
            });
            localStorage.setItem('medicationLog', JSON.stringify(medicationLog));
        }

        function orderRefill(medicationId) {
            // Simulate ordering refill from nearby pharmacy
            showNotification('üìû Contacting MedPlus Pharmacy for refill...');
            
            setTimeout(() => {
                showNotification('‚úÖ Refill order placed! Ready for pickup in 2 hours.');
            }, 2000);
        }

        function setRefillReminder(medicationId) {
            const reminderTime = new Date();
            reminderTime.setDate(reminderTime.getDate() + 5); // Remind in 5 days
            
            showNotification('üîî Refill reminder set for 5 days from now');
        }

        // Process pharmacy bill data
        function processPharmaycBill(pharmacyData) {
            if (pharmacyData && pharmacyData.medications) {
                // Add medications to today's list
                const todayMeds = document.getElementById('todayMedications');
                
                pharmacyData.medications.forEach(med => {
                    // Set up automatic reminders based on pharmacy data
                    med.reminderTimes.forEach(time => {
                        scheduleNotification(med.name, time);
                    });
                });
                
                showNotification(`üìã Received ${pharmacyData.medications.length} medications from ${pharmacyData.pharmacy.name}`);
            }
        }

        function scheduleNotification(medicationName, time) {
            if ('Notification' in window && Notification.permission === 'granted') {
                const now = new Date();
                const [hours, minutes] = time.split(':');
                const notificationTime = new Date();
                notificationTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                
                if (notificationTime <= now) {
                    notificationTime.setDate(notificationTime.getDate() + 1);
                }
                
                const timeUntil = notificationTime.getTime() - now.getTime();
                
                setTimeout(() => {
                    new Notification(`Time to take ${medicationName}!`, {
                        body: `It's ${time} - Don't forget your medication.`,
                        icon: '/favicon.ico',
                        tag: 'medication-reminder',
                        requireInteraction: true
                    });
                    
                    if ('vibrate' in navigator) {
                        navigator.vibrate([500, 200, 500]);
                    }
                }, timeUntil);
            }
        }

        // Utility functions
        function syncWithPharmacy() {
            showNotification('üîÑ Syncing with pharmacy systems...');
            
            setTimeout(() => {
                showNotification('‚úÖ Sync complete! All medications up to date.');
            }, 2000);
        }

        function callPharmacy(pharmacyName) {
            // Simulate calling pharmacy
            const phoneNumber = '+919876543210';
            window.location.href = `tel:${phoneNumber}`;
            showNotification(`üìû Calling ${pharmacyName}...`);
        }

        function loadMedicationData() {
            // Load any stored medication data
            const medicationLog = localStorage.getItem('medicationLog');
            if (medicationLog) {
                console.log('Loaded medication history:', JSON.parse(medicationLog));
            }
        }

        function addMedication() {
            showNotification('‚ûï Opening medication entry form...');
        }

        function viewHistory() {
            showNotification('üìä Loading medication history...');
        }

        function emergencyContacts() {
            showNotification('üö® Loading emergency contacts...');
        }

        function settingsMenu() {
            showNotification('‚öôÔ∏è Opening settings...');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        function showNotification(message) {
            const notification = document.getElementById('successNotification');
            document.getElementById('notificationMessage').textContent = message;
            notification.classList.remove('hidden');
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 4000);
        }

        // Request notification permission on load
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // Simulate location-based alert after 5 seconds
        setTimeout(() => {
            if (Math.random() > 0.5) { // 50% chance to show demo alert
                triggerPharmacyAlert({ name: 'MedPlus Pharmacy', distance: 85 });
            }
        }, 5000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96a0aca3c2b2b85b',t:'MTc1NDMzNzk3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
